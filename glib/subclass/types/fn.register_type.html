<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Register a `glib::Type` ID for `T`."><meta name="keywords" content="rust, rustlang, rust-lang, register_type"><title>register_type in glib::subclass::types - Rust</title><link rel="stylesheet" type="text/css" href="../../../normalize.css"><link rel="stylesheet" type="text/css" href="../../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../../light.css"  id="themeStyle"><link rel="stylesheet" type="text/css" href="../../../dark.css" disabled ><link rel="stylesheet" type="text/css" href="../../../ayu.css" disabled ><script id="default-settings"></script><script src="../../../storage.js"></script><script src="../../../crates.js"></script><noscript><link rel="stylesheet" href="../../../noscript.css"></noscript><link rel="icon" type="image/svg+xml" href="../../../favicon.svg">
<link rel="alternate icon" type="image/png" href="../../../favicon-16x16.png">
<link rel="alternate icon" type="image/png" href="../../../favicon-32x32.png"><style type="text/css">#crate-search{background-image:url("../../../down-arrow.svg");}</style></head><body class="rustdoc fn"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu" role="button">&#9776;</div><a href='../../../glib/index.html'><div class='logo-container rust-logo'><img src='../../../rust-logo.png' alt='logo'></div></a><div class="sidebar-elems"><p class="location"><a href="../../index.html">glib</a>::<wbr><a href="../index.html">subclass</a>::<wbr><a href="index.html">types</a></p><div id="sidebar-vars" data-name="register_type" data-ty="fn" data-relpath=""></div><script defer src="sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu"><img src="../../../brush.svg" width="18" height="18" alt="Pick another theme!"></button><div id="theme-choices" role="menu"></div></div><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" id="help-button">?</button>
                <a id="settings-menu" href="../../../settings.html"><img src="../../../wheel.svg" width="18" height="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><h1 class="fqn"><span class="in-band">Function <a href="../../index.html">glib</a>::<wbr><a href="../index.html">subclass</a>::<wbr><a href="index.html">types</a>::<wbr><a class="fn" href="">register_type</a><button id="copy-path" onclick="copy_path(this)"><img src="../../../clipboard.svg" width="19" height="18" alt="Copy item import"></button></span><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="../../../src/glib/subclass/types.rs.html#735-801" title="goto source code">[src]</a></span></h1><pre class="rust fn">pub fn register_type&lt;T:&nbsp;<a class="trait" href="trait.ObjectSubclass.html" title="trait glib::subclass::types::ObjectSubclass">ObjectSubclass</a>&gt;() -&gt; <a class="struct" href="../../types/struct.Type.html" title="struct glib::types::Type">Type</a></pre><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Register a <code>glib::Type</code> ID for <code>T</code>.</p>
<p>This must be called only once and will panic on a second call.</p>
<p>The <a href="../../macro.object_subclass.html"><code>object_subclass!</code></a> macro will create a <code>type_()</code> function around this, which will
ensure that it’s only ever called once.</p>
</div></details><div class="docblock scraped-example-list">
          <h1 id="scraped-examples" class="small-section-header">
             <a href="#scraped-examples">Uses found in <code>examples/</code></a>
          </h1><div class="scraped-example" data-code="use gtk::glib;
use gtk::subclass::prelude::*;
use gtk::{prelude::*, CompositeTemplate};

/// The private struct, which can hold widgets and other data.
#[derive(Debug, Default, CompositeTemplate)]
#[template(file = &quot;composite_template.ui&quot;)]
pub struct ExampleApplicationWindow {
    // The #[template_child] attribute tells the CompositeTemplate macro
    // that a field is meant to be a child within the template.
    #[template_child]
    pub headerbar: TemplateChild<gtk::HeaderBar>,
    #[template_child]
    pub label: TemplateChild<gtk::Label>,
    // You can specify the optional `id` argument if the id is not the same
    // as the identifier
    #[template_child(id = &quot;subtitle_label&quot;)]
    pub subtitle: TemplateChild<gtk::Label>,
}

#[glib::object_subclass]
impl ObjectSubclass for ExampleApplicationWindow {
    const NAME: &'static str = &quot;ExampleApplicationWindow&quot;;
    type Type = super::ExampleApplicationWindow;
    type ParentType = gtk::ApplicationWindow;

    // Within class_init() you must set the template.
    // The CompositeTemplate derive macro provides a convenience function
    // bind_template() to set the template and bind all children at once.
    fn class_init(klass: &mut Self::Class) {
        Self::bind_template(klass);
    }

    // You must call `Widget`'s `init_template()` within `instance_init()`.
    fn instance_init(obj: &glib::subclass::InitializingObject<Self>) {
        obj.init_template();
    }
}

impl ObjectImpl for ExampleApplicationWindow {
    fn constructed(&self, obj: &Self::Type) {
        obj.init_label();
        self.parent_constructed(obj);
    }
}

impl WidgetImpl for ExampleApplicationWindow {}
impl ContainerImpl for ExampleApplicationWindow {}
impl BinImpl for ExampleApplicationWindow {}
impl WindowImpl for ExampleApplicationWindow {}
impl ApplicationWindowImpl for ExampleApplicationWindow {}
" data-locs="[[2019,2043]]">
                <strong><a href="../../../src/composite_template/example_application_window/imp.rs.html" target="_blank">examples/composite_template/example_application_window/imp.rs</a></strong>
                 <div class="code-wrapper"><span class="prev">&pr;</span> <span class="next">&sc;</span><span class="expand">&varr;</span><div class="example-wrap"><pre class="line-numbers"><span id="1"> 1</span>
<span id="2"> 2</span>
<span id="3"> 3</span>
<span id="4"> 4</span>
<span id="5"> 5</span>
<span id="6"> 6</span>
<span id="7"> 7</span>
<span id="8"> 8</span>
<span id="9"> 9</span>
<span id="10">10</span>
<span id="11">11</span>
<span id="12">12</span>
<span id="13">13</span>
<span id="14">14</span>
<span id="15">15</span>
<span id="16">16</span>
<span id="17">17</span>
<span id="18">18</span>
<span id="19">19</span>
<span id="20">20</span>
<span id="21">21</span>
<span id="22">22</span>
<span id="23">23</span>
<span id="24">24</span>
<span id="25">25</span>
<span id="26">26</span>
<span id="27">27</span>
<span id="28">28</span>
<span id="29">29</span>
<span id="30">30</span>
<span id="31">31</span>
<span id="32">32</span>
<span id="33">33</span>
<span id="34">34</span>
<span id="35">35</span>
<span id="36">36</span>
<span id="37">37</span>
<span id="38">38</span>
<span id="39">39</span>
<span id="40">40</span>
<span id="41">41</span>
<span id="42">42</span>
<span id="43">43</span>
<span id="44">44</span>
<span id="45">45</span>
<span id="46">46</span>
<span id="47">47</span>
<span id="48">48</span>
<span id="49">49</span>
<span id="50">50</span>
<span id="51">51</span>
</pre><pre class="rust">
<span class="kw">use</span> <span class="ident">gtk::glib</span>;
<span class="kw">use</span> <span class="ident">gtk::subclass::prelude</span>::<span class="kw-2">*</span>;
<span class="kw">use</span> <span class="ident">gtk</span>::{<span class="ident">prelude</span>::<span class="kw-2">*</span>, <span class="ident">CompositeTemplate</span>};

<span class="doccomment">/// The private struct, which can hold widgets and other data.</span>
<span class="attribute">#[<span class="ident">derive</span>(<span class="ident">Debug</span>, <span class="ident">Default</span>, <span class="ident">CompositeTemplate</span>)]</span>
<span class="attribute">#[<span class="ident">template</span>(<span class="ident">file</span> <span class="op">=</span> <span class="string">&quot;composite_template.ui&quot;</span>)]</span>
<span class="kw">pub</span> <span class="kw">struct</span> <span class="ident">ExampleApplicationWindow</span> {
    <span class="comment">// The #[template_child] attribute tells the CompositeTemplate macro</span>
    <span class="comment">// that a field is meant to be a child within the template.</span>
    <span class="attribute">#[<span class="ident">template_child</span>]</span>
    <span class="kw">pub</span> <span class="ident">headerbar</span>: <span class="ident">TemplateChild</span><span class="op">&lt;</span><span class="ident">gtk::HeaderBar</span><span class="op">&gt;</span>,
    <span class="attribute">#[<span class="ident">template_child</span>]</span>
    <span class="kw">pub</span> <span class="ident">label</span>: <span class="ident">TemplateChild</span><span class="op">&lt;</span><span class="ident">gtk::Label</span><span class="op">&gt;</span>,
    <span class="comment">// You can specify the optional `id` argument if the id is not the same</span>
    <span class="comment">// as the identifier</span>
    <span class="attribute">#[<span class="ident">template_child</span>(<span class="ident">id</span> <span class="op">=</span> <span class="string">&quot;subtitle_label&quot;</span>)]</span>
    <span class="kw">pub</span> <span class="ident">subtitle</span>: <span class="ident">TemplateChild</span><span class="op">&lt;</span><span class="ident">gtk::Label</span><span class="op">&gt;</span>,
}

<span class="attribute">#[<span class="ident">glib::object_subclass</span>]</span>
<span class="kw">impl</span> <span class="ident">ObjectSubclass</span> <span class="kw">for</span> <span class="ident">ExampleApplicationWindow</span> {
    <span class="kw">const</span> <span class="ident">NAME</span>: <span class="kw-2">&amp;</span><span class="lifetime">&#39;static</span> <span class="ident">str</span> <span class="op">=</span> <span class="string">&quot;ExampleApplicationWindow&quot;</span>;
    <span class="kw">type</span> <span class="ident">Type</span> <span class="op">=</span> <span class="kw">super</span><span class="ident">::ExampleApplicationWindow</span>;
    <span class="kw">type</span> <span class="ident">ParentType</span> <span class="op">=</span> <span class="ident">gtk::ApplicationWindow</span>;

    <span class="comment">// Within class_init() you must set the template.</span>
    <span class="comment">// The CompositeTemplate derive macro provides a convenience function</span>
    <span class="comment">// bind_template() to set the template and bind all children at once.</span>
    <span class="kw">fn</span> <span class="ident">class_init</span>(<span class="ident">klass</span>: <span class="kw-2">&amp;</span><span class="kw-2">mut</span> <span class="self">Self</span><span class="ident">::Class</span>) {
        <span class="self">Self</span><span class="ident">::bind_template</span>(<span class="ident">klass</span>);
    }

    <span class="comment">// You must call `Widget`&#39;s `init_template()` within `instance_init()`.</span>
    <span class="kw">fn</span> <span class="ident">instance_init</span>(<span class="ident">obj</span>: <span class="kw-2">&amp;</span><span class="ident">glib::subclass::InitializingObject</span><span class="op">&lt;</span><span class="self">Self</span><span class="op">&gt;</span>) {
        <span class="ident">obj</span>.<span class="ident">init_template</span>();
    }
}

<span class="kw">impl</span> <span class="ident">ObjectImpl</span> <span class="kw">for</span> <span class="ident">ExampleApplicationWindow</span> {
    <span class="kw">fn</span> <span class="ident">constructed</span>(<span class="kw-2">&amp;</span><span class="self">self</span>, <span class="ident">obj</span>: <span class="kw-2">&amp;</span><span class="self">Self</span><span class="ident">::Type</span>) {
        <span class="ident">obj</span>.<span class="ident">init_label</span>();
        <span class="self">self</span>.<span class="ident">parent_constructed</span>(<span class="ident">obj</span>);
    }
}

<span class="kw">impl</span> <span class="ident">WidgetImpl</span> <span class="kw">for</span> <span class="ident">ExampleApplicationWindow</span> {}
<span class="kw">impl</span> <span class="ident">ContainerImpl</span> <span class="kw">for</span> <span class="ident">ExampleApplicationWindow</span> {}
<span class="kw">impl</span> <span class="ident">BinImpl</span> <span class="kw">for</span> <span class="ident">ExampleApplicationWindow</span> {}
<span class="kw">impl</span> <span class="ident">WindowImpl</span> <span class="kw">for</span> <span class="ident">ExampleApplicationWindow</span> {}
<span class="kw">impl</span> <span class="ident">ApplicationWindowImpl</span> <span class="kw">for</span> <span class="ident">ExampleApplicationWindow</span> {}
</pre></div>
</div></div><details class="rustdoc-toggle more-examples-toggle">
                  <summary class="hideme">
                     <span>More examples</span>
                  </summary>
                  <div class="more-scraped-examples"><div class="scraped-example" data-code="use glib::clone;
use gtk::glib;
use gtk::prelude::*;
use gtk::subclass::prelude::*;
use once_cell::unsync::OnceCell;
use std::cell::Cell;

#[derive(Debug)]
struct WindowWidgets {
    headerbar: gtk::HeaderBar,
    increment: gtk::Button,
    label: gtk::Label,
}

#[derive(Debug, Default)]
pub struct SimpleWindow {
    widgets: OnceCell<WindowWidgets>,
    counter: Cell<u64>,
}

#[glib::object_subclass]
impl ObjectSubclass for SimpleWindow {
    const NAME: &'static str = &quot;SimpleWindow&quot;;
    type Type = super::SimpleWindow;
    type ParentType = gtk::ApplicationWindow;
}

impl ObjectImpl for SimpleWindow {
    // Here we are overriding the glib::Objcet::contructed
    // method. Its what gets called when we create our Object
    // and where we can initialize things.
    fn constructed(&self, obj: &Self::Type) {
        self.parent_constructed(obj);

        let headerbar = gtk::HeaderBar::new();
        let increment = gtk::Button::with_label(&quot;Increment!&quot;);
        let label = gtk::Label::new(Some(&quot;Press the Increment Button!&quot;));

        headerbar.set_title(Some(&quot;Hello World!&quot;));
        headerbar.set_show_close_button(true);
        headerbar.pack_start(&increment);

        // Connect our method `on_increment_clicked` to be called
        // when the increment button is clicked.
        increment.connect_clicked(clone!(@weak obj => move |_| {
            let priv_ = SimpleWindow::from_instance(&obj);
            priv_.on_increment_clicked();
        }));

        obj.add(&label);
        obj.set_titlebar(Some(&headerbar));
        obj.set_default_size(640, 480);

        self.widgets
            .set(WindowWidgets {
                headerbar,
                increment,
                label,
            })
            .expect(&quot;Failed to initialize window state&quot;);
    }
}

impl SimpleWindow {
    fn on_increment_clicked(&self) {
        self.counter.set(self.counter.get() + 1);
        let w = self.widgets.get().unwrap();
        w.label
            .set_text(&format!(&quot;Counter is {}&quot;, self.counter.get()));
    }
}

impl WidgetImpl for SimpleWindow {}
impl ContainerImpl for SimpleWindow {}
impl BinImpl for SimpleWindow {}
impl WindowImpl for SimpleWindow {}
impl ApplicationWindowImpl for SimpleWindow {}
" data-locs="[[3733,3757]]">
                <strong><a href="../../../src/basic_subclass/simple_window/imp.rs.html" target="_blank">examples/basic_subclass/simple_window/imp.rs</a></strong>
                 <div class="code-wrapper"><span class="prev">&pr;</span> <span class="next">&sc;</span><span class="expand">&varr;</span><div class="example-wrap"><pre class="line-numbers"><span id="1"> 1</span>
<span id="2"> 2</span>
<span id="3"> 3</span>
<span id="4"> 4</span>
<span id="5"> 5</span>
<span id="6"> 6</span>
<span id="7"> 7</span>
<span id="8"> 8</span>
<span id="9"> 9</span>
<span id="10">10</span>
<span id="11">11</span>
<span id="12">12</span>
<span id="13">13</span>
<span id="14">14</span>
<span id="15">15</span>
<span id="16">16</span>
<span id="17">17</span>
<span id="18">18</span>
<span id="19">19</span>
<span id="20">20</span>
<span id="21">21</span>
<span id="22">22</span>
<span id="23">23</span>
<span id="24">24</span>
<span id="25">25</span>
<span id="26">26</span>
<span id="27">27</span>
<span id="28">28</span>
<span id="29">29</span>
<span id="30">30</span>
<span id="31">31</span>
<span id="32">32</span>
<span id="33">33</span>
<span id="34">34</span>
<span id="35">35</span>
<span id="36">36</span>
<span id="37">37</span>
<span id="38">38</span>
<span id="39">39</span>
<span id="40">40</span>
<span id="41">41</span>
<span id="42">42</span>
<span id="43">43</span>
<span id="44">44</span>
<span id="45">45</span>
<span id="46">46</span>
<span id="47">47</span>
<span id="48">48</span>
<span id="49">49</span>
<span id="50">50</span>
<span id="51">51</span>
<span id="52">52</span>
<span id="53">53</span>
<span id="54">54</span>
<span id="55">55</span>
<span id="56">56</span>
<span id="57">57</span>
<span id="58">58</span>
<span id="59">59</span>
<span id="60">60</span>
<span id="61">61</span>
<span id="62">62</span>
<span id="63">63</span>
<span id="64">64</span>
<span id="65">65</span>
<span id="66">66</span>
<span id="67">67</span>
<span id="68">68</span>
<span id="69">69</span>
<span id="70">70</span>
<span id="71">71</span>
<span id="72">72</span>
<span id="73">73</span>
<span id="74">74</span>
<span id="75">75</span>
<span id="76">76</span>
<span id="77">77</span>
</pre><pre class="rust">
<span class="kw">use</span> <span class="ident">glib::clone</span>;
<span class="kw">use</span> <span class="ident">gtk::glib</span>;
<span class="kw">use</span> <span class="ident">gtk::prelude</span>::<span class="kw-2">*</span>;
<span class="kw">use</span> <span class="ident">gtk::subclass::prelude</span>::<span class="kw-2">*</span>;
<span class="kw">use</span> <span class="ident">once_cell::unsync::OnceCell</span>;
<span class="kw">use</span> <span class="ident">std::cell::Cell</span>;

<span class="attribute">#[<span class="ident">derive</span>(<span class="ident">Debug</span>)]</span>
<span class="kw">struct</span> <span class="ident">WindowWidgets</span> {
    <span class="ident">headerbar</span>: <span class="ident">gtk::HeaderBar</span>,
    <span class="ident">increment</span>: <span class="ident">gtk::Button</span>,
    <span class="ident">label</span>: <span class="ident">gtk::Label</span>,
}

<span class="attribute">#[<span class="ident">derive</span>(<span class="ident">Debug</span>, <span class="ident">Default</span>)]</span>
<span class="kw">pub</span> <span class="kw">struct</span> <span class="ident">SimpleWindow</span> {
    <span class="ident">widgets</span>: <span class="ident">OnceCell</span><span class="op">&lt;</span><span class="ident">WindowWidgets</span><span class="op">&gt;</span>,
    <span class="ident">counter</span>: <span class="ident">Cell</span><span class="op">&lt;</span><span class="ident">u64</span><span class="op">&gt;</span>,
}

<span class="attribute">#[<span class="ident">glib::object_subclass</span>]</span>
<span class="kw">impl</span> <span class="ident">ObjectSubclass</span> <span class="kw">for</span> <span class="ident">SimpleWindow</span> {
    <span class="kw">const</span> <span class="ident">NAME</span>: <span class="kw-2">&amp;</span><span class="lifetime">&#39;static</span> <span class="ident">str</span> <span class="op">=</span> <span class="string">&quot;SimpleWindow&quot;</span>;
    <span class="kw">type</span> <span class="ident">Type</span> <span class="op">=</span> <span class="kw">super</span><span class="ident">::SimpleWindow</span>;
    <span class="kw">type</span> <span class="ident">ParentType</span> <span class="op">=</span> <span class="ident">gtk::ApplicationWindow</span>;
}

<span class="kw">impl</span> <span class="ident">ObjectImpl</span> <span class="kw">for</span> <span class="ident">SimpleWindow</span> {
    <span class="comment">// Here we are overriding the glib::Objcet::contructed</span>
    <span class="comment">// method. Its what gets called when we create our Object</span>
    <span class="comment">// and where we can initialize things.</span>
    <span class="kw">fn</span> <span class="ident">constructed</span>(<span class="kw-2">&amp;</span><span class="self">self</span>, <span class="ident">obj</span>: <span class="kw-2">&amp;</span><span class="self">Self</span><span class="ident">::Type</span>) {
        <span class="self">self</span>.<span class="ident">parent_constructed</span>(<span class="ident">obj</span>);

        <span class="kw">let</span> <span class="ident">headerbar</span> <span class="op">=</span> <span class="ident">gtk::HeaderBar::new</span>();
        <span class="kw">let</span> <span class="ident">increment</span> <span class="op">=</span> <span class="ident">gtk::Button::with_label</span>(<span class="string">&quot;Increment!&quot;</span>);
        <span class="kw">let</span> <span class="ident">label</span> <span class="op">=</span> <span class="ident">gtk::Label::new</span>(<span class="prelude-val">Some</span>(<span class="string">&quot;Press the Increment Button!&quot;</span>));

        <span class="ident">headerbar</span>.<span class="ident">set_title</span>(<span class="prelude-val">Some</span>(<span class="string">&quot;Hello World!&quot;</span>));
        <span class="ident">headerbar</span>.<span class="ident">set_show_close_button</span>(<span class="bool-val">true</span>);
        <span class="ident">headerbar</span>.<span class="ident">pack_start</span>(<span class="kw-2">&amp;</span><span class="ident">increment</span>);

        <span class="comment">// Connect our method `on_increment_clicked` to be called</span>
        <span class="comment">// when the increment button is clicked.</span>
        <span class="ident">increment</span>.<span class="ident">connect_clicked</span>(<span class="macro">clone!</span>(@<span class="ident">weak</span> <span class="ident">obj</span> <span class="op">=</span><span class="op">&gt;</span> <span class="kw">move</span> <span class="op">|</span><span class="kw">_</span><span class="op">|</span> {
            <span class="kw">let</span> <span class="ident">priv_</span> <span class="op">=</span> <span class="ident">SimpleWindow::from_instance</span>(<span class="kw-2">&amp;</span><span class="ident">obj</span>);
            <span class="ident">priv_</span>.<span class="ident">on_increment_clicked</span>();
        }));

        <span class="ident">obj</span>.<span class="ident">add</span>(<span class="kw-2">&amp;</span><span class="ident">label</span>);
        <span class="ident">obj</span>.<span class="ident">set_titlebar</span>(<span class="prelude-val">Some</span>(<span class="kw-2">&amp;</span><span class="ident">headerbar</span>));
        <span class="ident">obj</span>.<span class="ident">set_default_size</span>(<span class="number">640</span>, <span class="number">480</span>);

        <span class="self">self</span>.<span class="ident">widgets</span>
            .<span class="ident">set</span>(<span class="ident">WindowWidgets</span> {
                <span class="ident">headerbar</span>,
                <span class="ident">increment</span>,
                <span class="ident">label</span>,
            })
            .<span class="ident">expect</span>(<span class="string">&quot;Failed to initialize window state&quot;</span>);
    }
}

<span class="kw">impl</span> <span class="ident">SimpleWindow</span> {
    <span class="kw">fn</span> <span class="ident">on_increment_clicked</span>(<span class="kw-2">&amp;</span><span class="self">self</span>) {
        <span class="self">self</span>.<span class="ident">counter</span>.<span class="ident">set</span>(<span class="self">self</span>.<span class="ident">counter</span>.<span class="ident">get</span>() <span class="op">+</span> <span class="number">1</span>);
        <span class="kw">let</span> <span class="ident">w</span> <span class="op">=</span> <span class="self">self</span>.<span class="ident">widgets</span>.<span class="ident">get</span>().<span class="ident">unwrap</span>();
        <span class="ident">w</span>.<span class="ident">label</span>
            .<span class="ident">set_text</span>(<span class="kw-2">&amp;</span><span class="macro">format!</span>(<span class="string">&quot;Counter is {}&quot;</span>, <span class="self">self</span>.<span class="ident">counter</span>.<span class="ident">get</span>()));
    }
}

<span class="kw">impl</span> <span class="ident">WidgetImpl</span> <span class="kw">for</span> <span class="ident">SimpleWindow</span> {}
<span class="kw">impl</span> <span class="ident">ContainerImpl</span> <span class="kw">for</span> <span class="ident">SimpleWindow</span> {}
<span class="kw">impl</span> <span class="ident">BinImpl</span> <span class="kw">for</span> <span class="ident">SimpleWindow</span> {}
<span class="kw">impl</span> <span class="ident">WindowImpl</span> <span class="kw">for</span> <span class="ident">SimpleWindow</span> {}
<span class="kw">impl</span> <span class="ident">ApplicationWindowImpl</span> <span class="kw">for</span> <span class="ident">SimpleWindow</span> {}
</pre></div>
</div></div><div class="scraped-example" data-code="use glib::subclass::prelude::*;
use gtk::{glib, prelude::*};
use std::cell::RefCell;

// The actual data structure that stores our values. This is not accessible
// directly from the outside.
#[derive(Default)]
pub struct RowData {
    name: RefCell<Option<String>>,
    count: RefCell<u32>,
}

// Basic declaration of our type for the GObject type system
#[glib::object_subclass]
impl ObjectSubclass for RowData {
    const NAME: &'static str = &quot;RowData&quot;;
    type Type = super::RowData;
    type ParentType = glib::Object;
}

// The ObjectImpl trait provides the setters/getters for GObject properties.
// Here we need to provide the values that are internally stored back to the
// caller, or store whatever new value the caller is providing.
//
// This maps between the GObject properties and our internal storage of the
// corresponding values of the properties.
impl ObjectImpl for RowData {
    fn properties() -> &'static [glib::ParamSpec] {
        use once_cell::sync::Lazy;
        static PROPERTIES: Lazy<Vec<glib::ParamSpec>> = Lazy::new(|| {
            vec![
                glib::ParamSpec::new_string(
                    &quot;name&quot;,
                    &quot;Name&quot;,
                    &quot;Name&quot;,
                    None, // Default value
                    glib::ParamFlags::READWRITE,
                ),
                glib::ParamSpec::new_uint(
                    &quot;count&quot;,
                    &quot;Count&quot;,
                    &quot;Count&quot;,
                    0,
                    100,
                    0, // Allowed range and default value
                    glib::ParamFlags::READWRITE,
                ),
            ]
        });

        PROPERTIES.as_ref()
    }

    fn set_property(
        &self,
        _obj: &Self::Type,
        _id: usize,
        value: &glib::Value,
        pspec: &glib::ParamSpec,
    ) {
        match pspec.name() {
            &quot;name&quot; => {
                let name = value
                    .get()
                    .expect(&quot;type conformity checked by `Object::set_property`&quot;);
                self.name.replace(name);
            }
            &quot;count&quot; => {
                let count = value
                    .get()
                    .expect(&quot;type conformity checked by `Object::set_property`&quot;);
                self.count.replace(count);
            }
            _ => unimplemented!(),
        }
    }

    fn property(&self, _obj: &Self::Type, _id: usize, pspec: &glib::ParamSpec) -> glib::Value {
        match pspec.name() {
            &quot;name&quot; => self.name.borrow().to_value(),
            &quot;count&quot; => self.count.borrow().to_value(),
            _ => unimplemented!(),
        }
    }
}
" data-locs="[[11223,11247]]">
                <strong><a href="../../../src/list_box_model/row_data/imp.rs.html" target="_blank">examples/list_box_model/row_data/imp.rs</a></strong>
                 <div class="code-wrapper"><span class="prev">&pr;</span> <span class="next">&sc;</span><span class="expand">&varr;</span><div class="example-wrap"><pre class="line-numbers"><span id="1"> 1</span>
<span id="2"> 2</span>
<span id="3"> 3</span>
<span id="4"> 4</span>
<span id="5"> 5</span>
<span id="6"> 6</span>
<span id="7"> 7</span>
<span id="8"> 8</span>
<span id="9"> 9</span>
<span id="10">10</span>
<span id="11">11</span>
<span id="12">12</span>
<span id="13">13</span>
<span id="14">14</span>
<span id="15">15</span>
<span id="16">16</span>
<span id="17">17</span>
<span id="18">18</span>
<span id="19">19</span>
<span id="20">20</span>
<span id="21">21</span>
<span id="22">22</span>
<span id="23">23</span>
<span id="24">24</span>
<span id="25">25</span>
<span id="26">26</span>
<span id="27">27</span>
<span id="28">28</span>
<span id="29">29</span>
<span id="30">30</span>
<span id="31">31</span>
<span id="32">32</span>
<span id="33">33</span>
<span id="34">34</span>
<span id="35">35</span>
<span id="36">36</span>
<span id="37">37</span>
<span id="38">38</span>
<span id="39">39</span>
<span id="40">40</span>
<span id="41">41</span>
<span id="42">42</span>
<span id="43">43</span>
<span id="44">44</span>
<span id="45">45</span>
<span id="46">46</span>
<span id="47">47</span>
<span id="48">48</span>
<span id="49">49</span>
<span id="50">50</span>
<span id="51">51</span>
<span id="52">52</span>
<span id="53">53</span>
<span id="54">54</span>
<span id="55">55</span>
<span id="56">56</span>
<span id="57">57</span>
<span id="58">58</span>
<span id="59">59</span>
<span id="60">60</span>
<span id="61">61</span>
<span id="62">62</span>
<span id="63">63</span>
<span id="64">64</span>
<span id="65">65</span>
<span id="66">66</span>
<span id="67">67</span>
<span id="68">68</span>
<span id="69">69</span>
<span id="70">70</span>
<span id="71">71</span>
<span id="72">72</span>
<span id="73">73</span>
<span id="74">74</span>
<span id="75">75</span>
<span id="76">76</span>
<span id="77">77</span>
<span id="78">78</span>
<span id="79">79</span>
<span id="80">80</span>
<span id="81">81</span>
<span id="82">82</span>
<span id="83">83</span>
<span id="84">84</span>
<span id="85">85</span>
</pre><pre class="rust">
<span class="kw">use</span> <span class="ident">glib::subclass::prelude</span>::<span class="kw-2">*</span>;
<span class="kw">use</span> <span class="ident">gtk</span>::{<span class="ident">glib</span>, <span class="ident">prelude</span>::<span class="kw-2">*</span>};
<span class="kw">use</span> <span class="ident">std::cell::RefCell</span>;

<span class="comment">// The actual data structure that stores our values. This is not accessible</span>
<span class="comment">// directly from the outside.</span>
<span class="attribute">#[<span class="ident">derive</span>(<span class="ident">Default</span>)]</span>
<span class="kw">pub</span> <span class="kw">struct</span> <span class="ident">RowData</span> {
    <span class="ident">name</span>: <span class="ident">RefCell</span><span class="op">&lt;</span><span class="prelude-ty">Option</span><span class="op">&lt;</span><span class="ident">String</span><span class="op">&gt;</span><span class="op">&gt;</span>,
    <span class="ident">count</span>: <span class="ident">RefCell</span><span class="op">&lt;</span><span class="ident">u32</span><span class="op">&gt;</span>,
}

<span class="comment">// Basic declaration of our type for the GObject type system</span>
<span class="attribute">#[<span class="ident">glib::object_subclass</span>]</span>
<span class="kw">impl</span> <span class="ident">ObjectSubclass</span> <span class="kw">for</span> <span class="ident">RowData</span> {
    <span class="kw">const</span> <span class="ident">NAME</span>: <span class="kw-2">&amp;</span><span class="lifetime">&#39;static</span> <span class="ident">str</span> <span class="op">=</span> <span class="string">&quot;RowData&quot;</span>;
    <span class="kw">type</span> <span class="ident">Type</span> <span class="op">=</span> <span class="kw">super</span><span class="ident">::RowData</span>;
    <span class="kw">type</span> <span class="ident">ParentType</span> <span class="op">=</span> <span class="ident">glib::Object</span>;
}

<span class="comment">// The ObjectImpl trait provides the setters/getters for GObject properties.</span>
<span class="comment">// Here we need to provide the values that are internally stored back to the</span>
<span class="comment">// caller, or store whatever new value the caller is providing.</span>
<span class="comment">//</span>
<span class="comment">// This maps between the GObject properties and our internal storage of the</span>
<span class="comment">// corresponding values of the properties.</span>
<span class="kw">impl</span> <span class="ident">ObjectImpl</span> <span class="kw">for</span> <span class="ident">RowData</span> {
    <span class="kw">fn</span> <span class="ident">properties</span>() <span class="op">-</span><span class="op">&gt;</span> <span class="kw-2">&amp;</span><span class="lifetime">&#39;static</span> [<span class="ident">glib::ParamSpec</span>] {
        <span class="kw">use</span> <span class="ident">once_cell::sync::Lazy</span>;
        <span class="kw">static</span> <span class="ident">PROPERTIES</span>: <span class="ident">Lazy</span><span class="op">&lt;</span><span class="ident">Vec</span><span class="op">&lt;</span><span class="ident">glib::ParamSpec</span><span class="op">&gt;</span><span class="op">&gt;</span> <span class="op">=</span> <span class="ident">Lazy::new</span>(<span class="op">|</span><span class="op">|</span> {
            <span class="macro">vec!</span>[
                <span class="ident">glib::ParamSpec::new_string</span>(
                    <span class="string">&quot;name&quot;</span>,
                    <span class="string">&quot;Name&quot;</span>,
                    <span class="string">&quot;Name&quot;</span>,
                    <span class="prelude-val">None</span>, <span class="comment">// Default value</span>
                    <span class="ident">glib::ParamFlags::READWRITE</span>,
                ),
                <span class="ident">glib::ParamSpec::new_uint</span>(
                    <span class="string">&quot;count&quot;</span>,
                    <span class="string">&quot;Count&quot;</span>,
                    <span class="string">&quot;Count&quot;</span>,
                    <span class="number">0</span>,
                    <span class="number">100</span>,
                    <span class="number">0</span>, <span class="comment">// Allowed range and default value</span>
                    <span class="ident">glib::ParamFlags::READWRITE</span>,
                ),
            ]
        });

        <span class="ident">PROPERTIES</span>.<span class="ident">as_ref</span>()
    }

    <span class="kw">fn</span> <span class="ident">set_property</span>(
        <span class="kw-2">&amp;</span><span class="self">self</span>,
        <span class="ident">_obj</span>: <span class="kw-2">&amp;</span><span class="self">Self</span><span class="ident">::Type</span>,
        <span class="ident">_id</span>: <span class="ident">usize</span>,
        <span class="ident">value</span>: <span class="kw-2">&amp;</span><span class="ident">glib::Value</span>,
        <span class="ident">pspec</span>: <span class="kw-2">&amp;</span><span class="ident">glib::ParamSpec</span>,
    ) {
        <span class="kw">match</span> <span class="ident">pspec</span>.<span class="ident">name</span>() {
            <span class="string">&quot;name&quot;</span> <span class="op">=</span><span class="op">&gt;</span> {
                <span class="kw">let</span> <span class="ident">name</span> <span class="op">=</span> <span class="ident">value</span>
                    .<span class="ident">get</span>()
                    .<span class="ident">expect</span>(<span class="string">&quot;type conformity checked by `Object::set_property`&quot;</span>);
                <span class="self">self</span>.<span class="ident">name</span>.<span class="ident">replace</span>(<span class="ident">name</span>);
            }
            <span class="string">&quot;count&quot;</span> <span class="op">=</span><span class="op">&gt;</span> {
                <span class="kw">let</span> <span class="ident">count</span> <span class="op">=</span> <span class="ident">value</span>
                    .<span class="ident">get</span>()
                    .<span class="ident">expect</span>(<span class="string">&quot;type conformity checked by `Object::set_property`&quot;</span>);
                <span class="self">self</span>.<span class="ident">count</span>.<span class="ident">replace</span>(<span class="ident">count</span>);
            }
            <span class="kw">_</span> <span class="op">=</span><span class="op">&gt;</span> <span class="macro">unimplemented!</span>(),
        }
    }

    <span class="kw">fn</span> <span class="ident">property</span>(<span class="kw-2">&amp;</span><span class="self">self</span>, <span class="ident">_obj</span>: <span class="kw-2">&amp;</span><span class="self">Self</span><span class="ident">::Type</span>, <span class="ident">_id</span>: <span class="ident">usize</span>, <span class="ident">pspec</span>: <span class="kw-2">&amp;</span><span class="ident">glib::ParamSpec</span>) <span class="op">-</span><span class="op">&gt;</span> <span class="ident">glib::Value</span> {
        <span class="kw">match</span> <span class="ident">pspec</span>.<span class="ident">name</span>() {
            <span class="string">&quot;name&quot;</span> <span class="op">=</span><span class="op">&gt;</span> <span class="self">self</span>.<span class="ident">name</span>.<span class="ident">borrow</span>().<span class="ident">to_value</span>(),
            <span class="string">&quot;count&quot;</span> <span class="op">=</span><span class="op">&gt;</span> <span class="self">self</span>.<span class="ident">count</span>.<span class="ident">borrow</span>().<span class="ident">to_value</span>(),
            <span class="kw">_</span> <span class="op">=</span><span class="op">&gt;</span> <span class="macro">unimplemented!</span>(),
        }
    }
}
</pre></div>
</div></div><div class="scraped-example" data-code="//! Defines the implementation of our model

use gio::subclass::prelude::*;
use gtk::{gio, glib, prelude::*};

use std::cell::RefCell;

use crate::row_data::RowData;

#[derive(Debug, Default)]
pub struct Model(pub RefCell<Vec<RowData>>);

/// Basic declaration of our type for the GObject type system
#[glib::object_subclass]
impl ObjectSubclass for Model {
    const NAME: &'static str = &quot;Model&quot;;
    type Type = super::Model;
    type ParentType = glib::Object;
    type Interfaces = (gio::ListModel,);
}

impl ObjectImpl for Model {}

impl ListModelImpl for Model {
    fn item_type(&self, _list_model: &Self::Type) -> glib::Type {
        RowData::static_type()
    }
    fn n_items(&self, _list_model: &Self::Type) -> u32 {
        self.0.borrow().len() as u32
    }
    fn item(&self, _list_model: &Self::Type, position: u32) -> Option<glib::Object> {
        self.0
            .borrow()
            .get(position as usize)
            .map(|o| o.clone().upcast::<glib::Object>())
    }
}
" data-locs="[[9328,9352]]">
                <strong><a href="../../../src/list_box_model/model/imp.rs.html" target="_blank">examples/list_box_model/model/imp.rs</a></strong>
                 <div class="code-wrapper"><span class="prev">&pr;</span> <span class="next">&sc;</span><span class="expand">&varr;</span><div class="example-wrap"><pre class="line-numbers"><span id="1"> 1</span>
<span id="2"> 2</span>
<span id="3"> 3</span>
<span id="4"> 4</span>
<span id="5"> 5</span>
<span id="6"> 6</span>
<span id="7"> 7</span>
<span id="8"> 8</span>
<span id="9"> 9</span>
<span id="10">10</span>
<span id="11">11</span>
<span id="12">12</span>
<span id="13">13</span>
<span id="14">14</span>
<span id="15">15</span>
<span id="16">16</span>
<span id="17">17</span>
<span id="18">18</span>
<span id="19">19</span>
<span id="20">20</span>
<span id="21">21</span>
<span id="22">22</span>
<span id="23">23</span>
<span id="24">24</span>
<span id="25">25</span>
<span id="26">26</span>
<span id="27">27</span>
<span id="28">28</span>
<span id="29">29</span>
<span id="30">30</span>
<span id="31">31</span>
<span id="32">32</span>
<span id="33">33</span>
<span id="34">34</span>
<span id="35">35</span>
<span id="36">36</span>
<span id="37">37</span>
</pre><pre class="rust">
<span class="doccomment">//! Defines the implementation of our model</span>

<span class="kw">use</span> <span class="ident">gio::subclass::prelude</span>::<span class="kw-2">*</span>;
<span class="kw">use</span> <span class="ident">gtk</span>::{<span class="ident">gio</span>, <span class="ident">glib</span>, <span class="ident">prelude</span>::<span class="kw-2">*</span>};

<span class="kw">use</span> <span class="ident">std::cell::RefCell</span>;

<span class="kw">use</span> <span class="kw">crate</span><span class="ident">::row_data::RowData</span>;

<span class="attribute">#[<span class="ident">derive</span>(<span class="ident">Debug</span>, <span class="ident">Default</span>)]</span>
<span class="kw">pub</span> <span class="kw">struct</span> <span class="ident">Model</span>(<span class="kw">pub</span> <span class="ident">RefCell</span><span class="op">&lt;</span><span class="ident">Vec</span><span class="op">&lt;</span><span class="ident">RowData</span><span class="op">&gt;</span><span class="op">&gt;</span>);

<span class="doccomment">/// Basic declaration of our type for the GObject type system</span>
<span class="attribute">#[<span class="ident">glib::object_subclass</span>]</span>
<span class="kw">impl</span> <span class="ident">ObjectSubclass</span> <span class="kw">for</span> <span class="ident">Model</span> {
    <span class="kw">const</span> <span class="ident">NAME</span>: <span class="kw-2">&amp;</span><span class="lifetime">&#39;static</span> <span class="ident">str</span> <span class="op">=</span> <span class="string">&quot;Model&quot;</span>;
    <span class="kw">type</span> <span class="ident">Type</span> <span class="op">=</span> <span class="kw">super</span><span class="ident">::Model</span>;
    <span class="kw">type</span> <span class="ident">ParentType</span> <span class="op">=</span> <span class="ident">glib::Object</span>;
    <span class="kw">type</span> <span class="ident">Interfaces</span> <span class="op">=</span> (<span class="ident">gio::ListModel</span>,);
}

<span class="kw">impl</span> <span class="ident">ObjectImpl</span> <span class="kw">for</span> <span class="ident">Model</span> {}

<span class="kw">impl</span> <span class="ident">ListModelImpl</span> <span class="kw">for</span> <span class="ident">Model</span> {
    <span class="kw">fn</span> <span class="ident">item_type</span>(<span class="kw-2">&amp;</span><span class="self">self</span>, <span class="ident">_list_model</span>: <span class="kw-2">&amp;</span><span class="self">Self</span><span class="ident">::Type</span>) <span class="op">-</span><span class="op">&gt;</span> <span class="ident">glib::Type</span> {
        <span class="ident">RowData::static_type</span>()
    }
    <span class="kw">fn</span> <span class="ident">n_items</span>(<span class="kw-2">&amp;</span><span class="self">self</span>, <span class="ident">_list_model</span>: <span class="kw-2">&amp;</span><span class="self">Self</span><span class="ident">::Type</span>) <span class="op">-</span><span class="op">&gt;</span> <span class="ident">u32</span> {
        <span class="self">self</span>.<span class="number">0</span>.<span class="ident">borrow</span>().<span class="ident">len</span>() <span class="kw">as</span> <span class="ident">u32</span>
    }
    <span class="kw">fn</span> <span class="ident">item</span>(<span class="kw-2">&amp;</span><span class="self">self</span>, <span class="ident">_list_model</span>: <span class="kw-2">&amp;</span><span class="self">Self</span><span class="ident">::Type</span>, <span class="ident">position</span>: <span class="ident">u32</span>) <span class="op">-</span><span class="op">&gt;</span> <span class="prelude-ty">Option</span><span class="op">&lt;</span><span class="ident">glib::Object</span><span class="op">&gt;</span> {
        <span class="self">self</span>.<span class="number">0</span>
            .<span class="ident">borrow</span>()
            .<span class="ident">get</span>(<span class="ident">position</span> <span class="kw">as</span> <span class="ident">usize</span>)
            .<span class="ident">map</span>(<span class="op">|</span><span class="ident">o</span><span class="op">|</span> <span class="ident">o</span>.<span class="ident">clone</span>().<span class="ident">upcast</span>::<span class="op">&lt;</span><span class="ident">glib::Object</span><span class="op">&gt;</span>())
    }
}
</pre></div>
</div></div><div class="scraped-example" data-code="use gtk::glib;
use gtk::prelude::*;
use gtk::subclass::prelude::*;
use once_cell::unsync::OnceCell;

use crate::simple_window::SimpleWindow;

#[derive(Debug, Default)]
pub struct SimpleApplication {
    window: OnceCell<SimpleWindow>,
}

#[glib::object_subclass]
impl ObjectSubclass for SimpleApplication {
    const NAME: &'static str = &quot;SimpleApplication&quot;;
    type Type = super::SimpleApplication;
    type ParentType = gtk::Application;
}

impl ObjectImpl for SimpleApplication {}

/// When our application starts, the `startup` signal will be fired.
/// This gives us a chance to perform initialisation tasks that are not directly
/// related to showing a new window. After this, depending on how
/// the application is started, either `activate` or `open` will be called next.
impl ApplicationImpl for SimpleApplication {
    /// `gio::Application::activate` is what gets called when the
    /// application is launched by the desktop environment and
    /// aksed to present itself.
    fn activate(&self, app: &Self::Type) {
        let app = app.downcast_ref::<super::SimpleApplication>().unwrap();
        let priv_ = SimpleApplication::from_instance(app);
        let window = priv_
            .window
            .get()
            .expect(&quot;Should always be initiliazed in gio_application_startup&quot;);
        window.show_all();
        window.present();
    }

    /// `gio::Application` is bit special. It does not get initialized
    /// when `new` is called and the object created, but rather
    /// once the `startup` signal is emitted and the `gio::Application::startup`
    /// is called.
    ///
    /// Due to this, we create and initialize the `SimpleWindow` widget
    /// here. Widgets can't be created before `startup` has been called.
    fn startup(&self, app: &Self::Type) {
        self.parent_startup(app);

        let app = app.downcast_ref::<super::SimpleApplication>().unwrap();
        let priv_ = SimpleApplication::from_instance(app);
        let window = SimpleWindow::new(&app);
        priv_
            .window
            .set(window)
            .expect(&quot;Failed to initialize application window&quot;);
    }
}

impl GtkApplicationImpl for SimpleApplication {}
" data-locs="[[967,991]]">
                <strong><a href="../../../src/basic_subclass/simple_application/imp.rs.html" target="_blank">examples/basic_subclass/simple_application/imp.rs</a></strong>
                 <div class="code-wrapper"><span class="prev">&pr;</span> <span class="next">&sc;</span><span class="expand">&varr;</span><div class="example-wrap"><pre class="line-numbers"><span id="1"> 1</span>
<span id="2"> 2</span>
<span id="3"> 3</span>
<span id="4"> 4</span>
<span id="5"> 5</span>
<span id="6"> 6</span>
<span id="7"> 7</span>
<span id="8"> 8</span>
<span id="9"> 9</span>
<span id="10">10</span>
<span id="11">11</span>
<span id="12">12</span>
<span id="13">13</span>
<span id="14">14</span>
<span id="15">15</span>
<span id="16">16</span>
<span id="17">17</span>
<span id="18">18</span>
<span id="19">19</span>
<span id="20">20</span>
<span id="21">21</span>
<span id="22">22</span>
<span id="23">23</span>
<span id="24">24</span>
<span id="25">25</span>
<span id="26">26</span>
<span id="27">27</span>
<span id="28">28</span>
<span id="29">29</span>
<span id="30">30</span>
<span id="31">31</span>
<span id="32">32</span>
<span id="33">33</span>
<span id="34">34</span>
<span id="35">35</span>
<span id="36">36</span>
<span id="37">37</span>
<span id="38">38</span>
<span id="39">39</span>
<span id="40">40</span>
<span id="41">41</span>
<span id="42">42</span>
<span id="43">43</span>
<span id="44">44</span>
<span id="45">45</span>
<span id="46">46</span>
<span id="47">47</span>
<span id="48">48</span>
<span id="49">49</span>
<span id="50">50</span>
<span id="51">51</span>
<span id="52">52</span>
<span id="53">53</span>
<span id="54">54</span>
<span id="55">55</span>
<span id="56">56</span>
<span id="57">57</span>
<span id="58">58</span>
<span id="59">59</span>
<span id="60">60</span>
<span id="61">61</span>
</pre><pre class="rust">
<span class="kw">use</span> <span class="ident">gtk::glib</span>;
<span class="kw">use</span> <span class="ident">gtk::prelude</span>::<span class="kw-2">*</span>;
<span class="kw">use</span> <span class="ident">gtk::subclass::prelude</span>::<span class="kw-2">*</span>;
<span class="kw">use</span> <span class="ident">once_cell::unsync::OnceCell</span>;

<span class="kw">use</span> <span class="kw">crate</span><span class="ident">::simple_window::SimpleWindow</span>;

<span class="attribute">#[<span class="ident">derive</span>(<span class="ident">Debug</span>, <span class="ident">Default</span>)]</span>
<span class="kw">pub</span> <span class="kw">struct</span> <span class="ident">SimpleApplication</span> {
    <span class="ident">window</span>: <span class="ident">OnceCell</span><span class="op">&lt;</span><span class="ident">SimpleWindow</span><span class="op">&gt;</span>,
}

<span class="attribute">#[<span class="ident">glib::object_subclass</span>]</span>
<span class="kw">impl</span> <span class="ident">ObjectSubclass</span> <span class="kw">for</span> <span class="ident">SimpleApplication</span> {
    <span class="kw">const</span> <span class="ident">NAME</span>: <span class="kw-2">&amp;</span><span class="lifetime">&#39;static</span> <span class="ident">str</span> <span class="op">=</span> <span class="string">&quot;SimpleApplication&quot;</span>;
    <span class="kw">type</span> <span class="ident">Type</span> <span class="op">=</span> <span class="kw">super</span><span class="ident">::SimpleApplication</span>;
    <span class="kw">type</span> <span class="ident">ParentType</span> <span class="op">=</span> <span class="ident">gtk::Application</span>;
}

<span class="kw">impl</span> <span class="ident">ObjectImpl</span> <span class="kw">for</span> <span class="ident">SimpleApplication</span> {}

<span class="doccomment">/// When our application starts, the `startup` signal will be fired.</span>
<span class="doccomment">/// This gives us a chance to perform initialisation tasks that are not directly</span>
<span class="doccomment">/// related to showing a new window. After this, depending on how</span>
<span class="doccomment">/// the application is started, either `activate` or `open` will be called next.</span>
<span class="kw">impl</span> <span class="ident">ApplicationImpl</span> <span class="kw">for</span> <span class="ident">SimpleApplication</span> {
    <span class="doccomment">/// `gio::Application::activate` is what gets called when the</span>
    <span class="doccomment">/// application is launched by the desktop environment and</span>
    <span class="doccomment">/// aksed to present itself.</span>
    <span class="kw">fn</span> <span class="ident">activate</span>(<span class="kw-2">&amp;</span><span class="self">self</span>, <span class="ident">app</span>: <span class="kw-2">&amp;</span><span class="self">Self</span><span class="ident">::Type</span>) {
        <span class="kw">let</span> <span class="ident">app</span> <span class="op">=</span> <span class="ident">app</span>.<span class="ident">downcast_ref</span>::<span class="op">&lt;</span><span class="kw">super</span><span class="ident">::SimpleApplication</span><span class="op">&gt;</span>().<span class="ident">unwrap</span>();
        <span class="kw">let</span> <span class="ident">priv_</span> <span class="op">=</span> <span class="ident">SimpleApplication::from_instance</span>(<span class="ident">app</span>);
        <span class="kw">let</span> <span class="ident">window</span> <span class="op">=</span> <span class="ident">priv_</span>
            .<span class="ident">window</span>
            .<span class="ident">get</span>()
            .<span class="ident">expect</span>(<span class="string">&quot;Should always be initiliazed in gio_application_startup&quot;</span>);
        <span class="ident">window</span>.<span class="ident">show_all</span>();
        <span class="ident">window</span>.<span class="ident">present</span>();
    }

    <span class="doccomment">/// `gio::Application` is bit special. It does not get initialized</span>
    <span class="doccomment">/// when `new` is called and the object created, but rather</span>
    <span class="doccomment">/// once the `startup` signal is emitted and the `gio::Application::startup`</span>
    <span class="doccomment">/// is called.</span>
    <span class="doccomment">///</span>
    <span class="doccomment">/// Due to this, we create and initialize the `SimpleWindow` widget</span>
    <span class="doccomment">/// here. Widgets can&#39;t be created before `startup` has been called.</span>
    <span class="kw">fn</span> <span class="ident">startup</span>(<span class="kw-2">&amp;</span><span class="self">self</span>, <span class="ident">app</span>: <span class="kw-2">&amp;</span><span class="self">Self</span><span class="ident">::Type</span>) {
        <span class="self">self</span>.<span class="ident">parent_startup</span>(<span class="ident">app</span>);

        <span class="kw">let</span> <span class="ident">app</span> <span class="op">=</span> <span class="ident">app</span>.<span class="ident">downcast_ref</span>::<span class="op">&lt;</span><span class="kw">super</span><span class="ident">::SimpleApplication</span><span class="op">&gt;</span>().<span class="ident">unwrap</span>();
        <span class="kw">let</span> <span class="ident">priv_</span> <span class="op">=</span> <span class="ident">SimpleApplication::from_instance</span>(<span class="ident">app</span>);
        <span class="kw">let</span> <span class="ident">window</span> <span class="op">=</span> <span class="ident">SimpleWindow::new</span>(<span class="kw-2">&amp;</span><span class="ident">app</span>);
        <span class="ident">priv_</span>
            .<span class="ident">window</span>
            .<span class="ident">set</span>(<span class="ident">window</span>)
            .<span class="ident">expect</span>(<span class="string">&quot;Failed to initialize application window&quot;</span>);
    }
}

<span class="kw">impl</span> <span class="ident">GtkApplicationImpl</span> <span class="kw">for</span> <span class="ident">SimpleApplication</span> {}
</pre></div>
</div></div><div class="scraped-example" data-code="use glib::subclass::prelude::*;
use gtk::glib;

// FileSize is a simple object that will just contain the read file size.
// Initially the optional size field will be initialized to None.
#[derive(Default)]
pub struct FileSize {
    pub size: std::cell::RefCell<Option<i64>>,
}

#[glib::object_subclass]
impl ObjectSubclass for FileSize {
    const NAME: &'static str = &quot;FileSize&quot;;
    type ParentType = glib::Object;
    type Type = super::FileSize;
}

impl ObjectImpl for FileSize {}
" data-locs="[[8545,8569]]">
                <strong><a href="../../../src/gio_task/file_size/imp.rs.html" target="_blank">examples/gio_task/file_size/imp.rs</a></strong>
                 <div class="code-wrapper"><span class="prev">&pr;</span> <span class="next">&sc;</span><span class="expand">&varr;</span><div class="example-wrap"><pre class="line-numbers"><span id="1"> 1</span>
<span id="2"> 2</span>
<span id="3"> 3</span>
<span id="4"> 4</span>
<span id="5"> 5</span>
<span id="6"> 6</span>
<span id="7"> 7</span>
<span id="8"> 8</span>
<span id="9"> 9</span>
<span id="10">10</span>
<span id="11">11</span>
<span id="12">12</span>
<span id="13">13</span>
<span id="14">14</span>
<span id="15">15</span>
<span id="16">16</span>
<span id="17">17</span>
<span id="18">18</span>
</pre><pre class="rust">
<span class="kw">use</span> <span class="ident">glib::subclass::prelude</span>::<span class="kw-2">*</span>;
<span class="kw">use</span> <span class="ident">gtk::glib</span>;

<span class="comment">// FileSize is a simple object that will just contain the read file size.</span>
<span class="comment">// Initially the optional size field will be initialized to None.</span>
<span class="attribute">#[<span class="ident">derive</span>(<span class="ident">Default</span>)]</span>
<span class="kw">pub</span> <span class="kw">struct</span> <span class="ident">FileSize</span> {
    <span class="kw">pub</span> <span class="ident">size</span>: <span class="ident">std::cell::RefCell</span><span class="op">&lt;</span><span class="prelude-ty">Option</span><span class="op">&lt;</span><span class="ident">i64</span><span class="op">&gt;</span><span class="op">&gt;</span>,
}

<span class="attribute">#[<span class="ident">glib::object_subclass</span>]</span>
<span class="kw">impl</span> <span class="ident">ObjectSubclass</span> <span class="kw">for</span> <span class="ident">FileSize</span> {
    <span class="kw">const</span> <span class="ident">NAME</span>: <span class="kw-2">&amp;</span><span class="lifetime">&#39;static</span> <span class="ident">str</span> <span class="op">=</span> <span class="string">&quot;FileSize&quot;</span>;
    <span class="kw">type</span> <span class="ident">ParentType</span> <span class="op">=</span> <span class="ident">glib::Object</span>;
    <span class="kw">type</span> <span class="ident">Type</span> <span class="op">=</span> <span class="kw">super</span><span class="ident">::FileSize</span>;
}

<span class="kw">impl</span> <span class="ident">ObjectImpl</span> <span class="kw">for</span> <span class="ident">FileSize</span> {}
</pre></div>
</div></div></div></details></div></section><section id="search" class="content hidden"></section><div id="rustdoc-vars" data-root-path="../../../" data-current-crate="glib" data-search-index-js="../../../search-index.js" data-search-js="../../../search.js"></div>
    <script src="../../../main.js"></script></body></html>